# 需求管理规范

本文档定义如何使用 AI 工具生成、管理和追踪产品需求文档（PRD）。

## 需求编号规则

### 格式
```
REQ-YYYY-NNN
```
- `REQ`：需求标识符
- `YYYY`：年份（4 位数）
- `NNN`：序号（3 位数，从 001 开始）

### 示例
- `REQ-2025-001`：2025 年第一个需求
- `REQ-2025-042`：2025 年第 42 个需求

### 子需求编号
对于大型需求，可拆分为子需求：
```
REQ-YYYY-NNN-S
```
- `S`：子需求序号（A, B, C...）

示例：
- `REQ-2025-001-A`：用户登录功能
- `REQ-2025-001-B`：用户注册功能

## PRD 文档结构

### 标准模板
使用以下模板创建 PRD 文档，文件命名：`prd/REQ-YYYY-NNN-<简短描述>.md`

```markdown
# PRD: <需求标题>

**需求编号**：REQ-YYYY-NNN  
**创建日期**：YYYY-MM-DD  
**负责人**：@username  
**优先级**：P0 / P1 / P2 / P3  
**状态**：Draft / In Review / Approved / In Progress / Done / Cancelled

## 1. 背景与目标

### 1.1 业务背景
描述为什么需要这个功能，解决什么业务问题。

### 1.2 目标
- 明确的、可衡量的目标
- 预期收益与成功指标

## 2. 需求描述

### 2.1 功能需求
详细描述功能的具体要求。

### 2.2 非功能需求
- 性能要求
- 安全要求
- 可用性要求
- 兼容性要求

### 2.3 约束条件
技术、时间、资源等约束。

## 3. 用户故事

作为 [角色]，我希望 [功能]，以便 [价值]。

**验收标准**：
- [ ] 标准 1
- [ ] 标准 2
- [ ] 标准 3

## 4. 技术方案（概要）

### 4.1 系统架构
简述涉及的系统和模块。

### 4.2 接口设计
列出主要 API 接口。

### 4.3 数据模型
描述核心数据结构。

## 5. 依赖关系

### 5.1 依赖需求
- 依赖 REQ-YYYY-XXX：<描述>

### 5.2 被依赖需求
- 被 REQ-YYYY-YYY 依赖：<描述>

## 6. 时间计划

| 阶段 | 开始时间 | 结束时间 | 负责人 |
|------|----------|----------|--------|
| 需求评审 | | | |
| 设计 | | | |
| 开发 | | | |
| 测试 | | | |
| 上线 | | | |

## 7. 风险评估

| 风险 | 概率 | 影响 | 应对措施 |
|------|------|------|----------|
| | | | |

## 8. 附录

### 8.1 相关链接
- Issue: #XXX
- 设计文档: [链接]
- 原型: [链接]

### 8.2 变更记录

| 日期 | 版本 | 变更内容 | 修改人 |
|------|------|----------|--------|
| YYYY-MM-DD | 1.0 | 初始版本 | @username |
```

## AI 生成 PRD 的工作流

### 步骤 1：准备输入信息
收集需求的基本信息：
- 功能描述
- 业务背景
- 目标用户
- 预期收益

### 步骤 2：使用 AI 生成初稿
使用 GitHub Copilot、ChatGPT 或 Claude，提供以下 Prompt：

```
请根据以下信息生成一份产品需求文档（PRD）：

背景：[业务背景]
功能：[功能描述]
用户：[目标用户]
目标：[预期目标]

请按照以下结构生成：
1. 背景与目标
2. 需求描述（功能需求 + 非功能需求）
3. 用户故事与验收标准
4. 技术方案概要
5. 依赖关系
6. 时间计划
7. 风险评估

格式要求：Markdown，清晰易读，包含表格和列表。
```

### 步骤 3：人工审查与完善
- 审查 AI 生成的内容，确保准确性
- 补充技术细节
- 完善验收标准
- 添加依赖关系

### 步骤 4：分配需求编号
1. 查看 `prd/` 目录中最新的需求编号
2. 按规则分配新编号：`REQ-YYYY-NNN`
3. 在 PRD 文件中填写编号
4. 文件重命名为：`REQ-YYYY-NNN-<简短描述>.md`

### 步骤 5：提交与审查
1. 创建分支：`feature/req-2025-nnn-<desc>`
2. 提交 PRD 文档到 `prd/` 目录
3. 创建 Pull Request，标题：`docs(prd): add REQ-2025-NNN <简短描述>`
4. 邀请相关人员审查
5. 审查通过后合并到 `develop` 分支

## 需求状态管理

### 状态定义
- **Draft**：草稿，正在编写中
- **In Review**：审查中，等待反馈
- **Approved**：已批准，可以开始开发
- **In Progress**：开发中
- **Done**：已完成，已上线
- **Cancelled**：已取消

### 状态流转
```
Draft -> In Review -> Approved -> In Progress -> Done
                  \-> Cancelled
```

### 更新状态
在 PRD 文档头部更新状态字段，并记录在变更记录中。

## 需求变更管理

### 变更流程
1. 在原 PRD 文档中添加变更记录
2. 说明变更原因和影响范围
3. 更新版本号（如 1.0 -> 1.1）
4. 提交 PR，标题：`docs(prd): update REQ-YYYY-NNN <变更简述>`
5. 通知相关团队成员

### 重大变更
如果变更影响超过 30% 的原需求内容，考虑创建新需求编号。

## 需求追踪

### 创建 GitHub Issue
每个需求对应一个 GitHub Issue：
1. 标题格式：`[REQ-YYYY-NNN] <需求标题>`
2. 描述中链接到 PRD 文档
3. 添加标签：`requirement`, `prd`
4. 关联到 Project 看板

### 关联代码变更
所有相关的 PR 和 Commit 消息中应包含需求编号：
```
feat(auth): implement user login [REQ-2025-001]
```

## 最佳实践

1. **简洁明确**：PRD 应简洁清晰，避免冗长和模糊
2. **可衡量**：目标和验收标准应可衡量、可验证
3. **及时更新**：需求变更时及时更新文档
4. **版本控制**：所有 PRD 都应纳入 Git 版本管理
5. **AI 辅助**：利用 AI 提高效率，但人工审查必不可少
6. **单一职责**：每个需求聚焦单一功能或目标
7. **向前兼容**：预留扩展空间，避免频繁重构

## 示例

参考示例：`prd/REQ-2025-001-user-authentication.md`

## 工具推荐

### AI 工具
- **ChatGPT/Claude**：PRD 初稿生成
- **GitHub Copilot**：文档补全与优化
- **Grammarly**：语言润色（英文）

### 协作工具
- **GitHub Issues**：需求追踪
- **GitHub Projects**：看板管理
- **Miro/Figma**：原型与设计
- **Draw.io**：流程图与架构图

## 相关文档

- [需求代码映射](./requirement-code-mapping.md)
- [开发计划管理](./development-planning.md)
- [AI 开发工作流](./ai-development-workflow.md)
